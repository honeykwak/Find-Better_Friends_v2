# 5. 유사도 정렬 기능 및 개선 계획

이 문서는 'Find-Better_Friends_v2' 프로젝트에 새로 추가된 '유사도(Similarity)' 정렬 기능의 명세와 향후 개선 작업을 정의합니다.

---

### 1. 유사도(Similarity) 정렬 기능

#### 1.1. 기능 목표

사용자가 특정 검증인(기준 검증인)을 선택했을 때, 그 검증인과 투표 성향이 가장 유사한 다른 검증인들을 쉽게 찾을 수 있도록 지원합니다. 이는 "나와 비슷한 성향의 검증인 찾기"라는 프로젝트의 핵심 목표를 달성하기 위한 핵심 기능입니다.

#### 1.2. 핵심 원칙

- **투표 행위의 동등성:** `YES`, `NO`, `NO_WITH_VETO`, `ABSTAIN`, `NO_VOTE` 5가지 투표 행위는 모두 동등한 가치를 지닙니다. 특정 투표에 가중치를 부여하지 않으며, 오직 '일치'와 '불일치' 여부만으로 유사도를 판단합니다.

#### 1.3. 유사도 계산 로직: 완전 일치율 (Exact Match Percentage)

두 검증인(A, B)의 유사도는 다음과 같은 '완전 일치율' 방식으로 계산됩니다.

1.  **비교 대상:** 현재 필터링�� 모든 제안(Proposals).
2.  **일치(Match) 조건:** 각 제안에 대해 두 검증인의 투표가 **정확히 일치**하는 경우.
    - 예: A가 `YES`, B도 `YES`인 경우 (일치)
    - 예: A가 `NO_VOTE`, B도 `NO_VOTE`인 경우 (일치)
3.  **불일치(Mismatch) 조건:** 투표가 일치하지 않는 모든 경우.
    - 예: A가 `YES`, B가 `NO`인 경우 (불일치)
4.  **최종 점수:** `(일치한 제안의 수 / 전체 비교 제안의 수)`
    - 결과는 0(0% 일치)에서 1(100% 일치) 사이의 값을 가집니다.

---

### 2. 사용자 경험(UX) 개선 계획

현재 발견된 두 가지 주요 문제를 해결하여 사용자 경험을 개선합니다.

#### 2.1. 문제 1: 선택 검증인 변경 시 즉각적인 재정렬 부재

- **현상:** 사용자가 필터 패널에서 기준 검증인을 변경해도, 'Similarity' 정렬 버튼을 다시 클릭하지 않으면 히트맵이 재정렬되지 않습니다.
- **개선안:**
    - 사용자가 검증인을 **선택(`setSearchTerm`)하는 즉시, 정렬 기준을 'Similarity'로 자동 설정**하여 히트맵을 즉시 재정렬합니다.
    - 사용자가 검증인 선택을 **해제하면, 정렬 기준을 기본값('Vote Count')으로 복귀**시킵니다.

#### 2.2. 문제 2: 체인 변경 시 필터 상태 유지 오류

- **현상:** 사용자가 블록체인 네트워크(체인)를 변경할 때, 이전에 선택했던 검증인 정보(`searchTerm`)가 초기화되지 않고 남아있습니다.
- **개선안:**
    - 사용자가 체인을 **변경(`setSelectedChain`)하는 즉시, 선택된 검증인(`searchTerm`)을 포함한 모든 필터 관련 상태를 초기화**합니다. 이를 통해 각 체인은 완전히 독립적인 필터 상태를 갖게 됩니다.

상기 개선안은 `src/stores/useGlobalStore.ts` 파일 수정을 통해 진행될 예정입니다.
